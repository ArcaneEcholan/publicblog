---
title: '为什么应该尽量避免修改'
date: '2025-11-03'
tags: ['']
draft: false
summary:
---

![alt text](http://60.205.105.12:9001/images/why_should_avoid_introduce_changes-a_module.png)

# 引入

为什么代码“修改”是最应该避免的事情。为什么应该添加而不是修改和删除。

模块作为程序的管理单元，这里从模块的角度去尝试说明上面的问题。

一个模块意味着什么，为什么明确模块的边界是一个很重要的事情。模块分为接口和实现。其中，最应该关注的是接口。

接口意味着约定。约定就一定涉及到同意该约定的各方。随意修改约定（没经过约定各方同意），可以视为违约。


违约（Breach of contract） 是合同法中的专有术语，指合同当事人一方或双方未履行合同条款中约定的义务的情形。

例如：雇主拖欠工资、供应商不按约定交货、房地产项目烂尾等。

其法律后果取决于未履行义务是否可归责于当事人一方或双方，即是否存在可归责的违约行为。

总之，违约会导致约定各方无法达到预期效果。在编程中，该接口往往意味着牵一发而动全身。一个模块接口修改，接口依赖方需要重新开发调试，复测，部署。

模块的接口按约定的不同方大致分为：开发、测试、部署

# 先说开发依赖的接口

很具体，就是编程接口，比如 HTTP api（url，参数，返回值），函数（名称，参数，返回值，异常），Context 中能提供的参数，不同线程之间交换数据的方式（文件，变量等等）

改这部分东西会直接造成接口使用方重写。

如果接口调用封装得很好，可以由接口的实现方直接提供外表不变的接口客户端。

但是现实往往更复杂，因为接口往往没有清晰标识出来，比如context 中能提供的参数，这个版本能获取到参数a，下个版本可能就会拿到一个 null。线程之间的交互方式更是灾难，这部分只能依赖额外的内部开发文档说明标注，而就我工作过的公司而言，某个模块一般都是由一个人开发的，其内部实现可能就是开发者信手拈来，开发者走了，也就不知道为什么要这样设计了，文档更不可能，一个开发者一会儿要应付这个需求，一会要应付那个需求，根本没时间顾得上内部文档。函数，api还好定性，但就这，能好好写接口文档的我看也没几个人。接口调通了，跟前端测试口头说一下，要么就是边调边沟通，根本没有维护文档的习惯。boss都直接看程序跑没跑起来，功能有没有实现，文档如果公司没有规定，基本就是不可能有的。

总之，现实和客观的因素下，接口文档总是匮乏的，我见过的都是靠开发者自身的素养。

# 再说说测试依赖的接口

我是负责偏上层的应用模块。比如UI，已经JAVA去调用底层封装好的模块去对外提供HTTP服务。所以就两块，界面UI以及HTTP接口。

修改这部分接口会影响到用户手册怎么编写，比如界面的这个按钮为什么这个版本有，而那个版本却没有，甚至有些页面的名称、布局更改了都会引起测试的询问：唉你这个地方为什么要这样改。

总之这部分更多的是跟人打交道。只要你乐意不厌其烦地跟同时解释变更的原因，这部分应该不会是大问题。吧。

现实中面对某个UI的各方可能包括：测试、你的boss、客户。应该没人会想跟这么多人多费口舌吧。

#  最后说说部署时候的接口

部署主要和生产环境有关，这部分接口的变更可能引起生产环境的变更。

生产环境说具体点，就是部署的机器是什么系统，系统所处的网络环境是怎么样的，系统中的什么位置应该有什么支撑性文件（否则程序起不来或者异常），系统上应该安装什么程序（作为子程序被调用），程序的启动参数怎么传递。

举个例子，springboot里面那个application.xml的所有参数，都属于部署接口一部分。或者程序需要读取什么环境变量，JVM参数（-D)，负责支撑这些的代码最好是写在一起，以划分接口边界。

或者程序依赖什么文件，证书，那最好和上面一样写在一起，在某个阶段一起读取和处理。
