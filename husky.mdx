---
title: Husky
date: '2025-05-28'
tags: ['eslint', 'prettier', 'husky', 'pre-commit', 'è‡ªåŠ¨åŒ–']
draft: false
summary: |
  åœ¨æ¯æ¬¡ commit æ—¶è‡ªåŠ¨åŒ–æ ¼å¼åŒ–ä»£ç ï¼Œé¿å…ä»£ç é£æ ¼å†²çªï¼Œç»“åˆ ESLintã€Prettier å’Œ Husky å®ç°å…¨æµç¨‹ã€‚
---

ç›®æ ‡ï¼šåœ¨æ¯æ¬¡ **commit** æ—¶è‡ªåŠ¨åŒ–æ ¼å¼åŒ–ä»£ç ï¼Œ**é¿å…å›¢é˜Ÿå†…ä»£ç é£æ ¼å†²çª**ï¼Œæå‡ä»£ç ä¸€è‡´æ€§ã€‚ä¸‹é¢é€šè¿‡ `ESLint`ã€`Prettier` å’Œ `Husky` çš„ç»„åˆæ¥å®ç°ã€‚

---

### âœ… å®‰è£…ä¾èµ–

é¦–å…ˆï¼Œå®‰è£…æ ¸å¿ƒä¾èµ–ï¼ˆESLint + Prettier åŠå…¶é›†æˆæ’ä»¶ï¼‰ï¼š

```bash
npm install --save-dev eslint prettier eslint-config-prettier eslint-plugin-prettier
```

> ğŸ’¡ **ESLint** ä¸»è¦è´Ÿè´£è¯­æ³•æ£€æŸ¥ï¼Œæ ¼å¼åŒ–åªæ˜¯å®ƒçš„å°éƒ¨åˆ†åŠŸèƒ½ï¼Œé€šå¸¸ç»“åˆ **Prettier** è¿›è¡Œå®Œæ•´çš„ä»£ç æ ¼å¼åŒ–ã€‚

---

### âœ… ESLint é…ç½® `.eslintrc.js`

```js
module.exports = {
  extends: [
    "react-app",             // create-react-app å†…ç½®è§„åˆ™
    "react-app/jest",        // jest ç›¸å…³è§„åˆ™
    "plugin:prettier/recommended" // é›†æˆ prettierï¼Œè‡ªåŠ¨å…³é—­å†²çªè§„åˆ™
  ],
  rules: {
    // å¯æ ¹æ®å›¢é˜Ÿéœ€è¦è‡ªå®šä¹‰è§„åˆ™
    // "semi": ["error", "always"],
  }
};
```

---

### ğŸ“Œ `plugin:prettier/recommended` ä½œç”¨

è¿™ä¸ªé…ç½®åšäº†ä¸‰ä»¶äº‹ï¼š
- **ç¦ç”¨** ESLint ä¸­å’Œ Prettier å†²çªçš„è§„åˆ™ï¼ˆä½¿ç”¨ `eslint-config-prettier`ï¼‰ã€‚
- **å¯ç”¨** `eslint-plugin-prettier`ï¼Œå°† **Prettier ä½œä¸ºä¸€ä¸ª ESLint è§„åˆ™**ï¼ˆåä¸º `"prettier/prettier"`ï¼‰ã€‚
- å½“æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ Prettier ä¿®å¤é£æ ¼é—®é¢˜ï¼š

```bash
npx eslint --fix --debug src/
```

è¿™æ ·ï¼Œ**ESLint ä¸ Prettier å®Œç¾ç»“åˆ**ï¼Œåªéœ€ä¸€ä¸ªå‘½ä»¤å°±èƒ½åŒæ—¶å®Œæˆè¯­æ³•æ£€æŸ¥ä¸æ ¼å¼åŒ–ã€‚

---

### âœ… å®‰è£… Huskyï¼Œç®¡ç† pre-commit é’©å­

å®‰è£… Huskyï¼š
```bash
npm install husky --save-dev
```

åœ¨æ ¹ç›®å½•çš„ `package.json` ä¸­æ·»åŠ ï¼š
```json
{
  "scripts": {
    "prepare": "husky install"
  }
}
```

> ğŸ“ `prepare` è„šæœ¬ä¼šåœ¨æ‰§è¡Œ `npm install` åè‡ªåŠ¨è¿è¡Œï¼Œå¸®ä½ åˆå§‹åŒ– `.husky` ç›®å½•å¹¶é…ç½® git hooksã€‚

---

### âœ… åˆ›å»º pre-commit é’©å­

åœ¨æ ¹ç›®å½•åˆ›å»º `.husky/pre-commit` æ–‡ä»¶ï¼š

```bash
mkdir -p .husky
cat <<'EOF' > .husky/pre-commit
#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "Running ESLint Fix in ui/..."
cd ui
npx eslint --fix --debug "src/**/*.{js,jsx,ts,tsx}"
EOF
chmod +x .husky/pre-commit
```

è¿™æ ·ï¼Œæ¯æ¬¡ **`git commit`** æ—¶ï¼Œhusky ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ° `ui` ç›®å½•å¹¶è¿è¡Œ ESLint æ ¼å¼åŒ–ã€‚

---

### ğŸ“¦ ä¸€å®šè¦æ³¨æ„ `.git` å’Œ husky çš„ä½ç½®ï¼

Husky çš„é…ç½®ä¾èµ– **é¡¹ç›®æ ¹ç›®å½•**ï¼ˆ`.git` æ‰€åœ¨å¤„ï¼‰ï¼š
```
/root (æœ‰ .gitã€.husky)
 â”œâ”€ package.json     ğŸ‘ˆ æ ¹ç›®å½•ï¼ŒåŒ…å« prepareã€husky é…ç½®
 â”œâ”€ backend/
 â””â”€ ui/              ğŸ‘ˆ å­é¡¹ç›®ï¼ŒåŒ…å«è‡ªå·±çš„ package.jsonï¼ˆä¾èµ–ã€eslintã€prettierï¼‰
```

> âš ï¸ Husky åªèƒ½åœ¨ `.git` æ‰€åœ¨çš„ç›®å½•é…ç½®ã€‚å¦‚æœä½ çš„å‰ç«¯é¡¹ç›®æ˜¯æ”¾åœ¨åç«¯çš„å­ç›®å½•ï¼ˆæ¯”å¦‚ `backend/ui/`ï¼‰ï¼Œç¡®ä¿ husky ä»åœ¨æ ¹ç›®å½•å¹¶æ‰§è¡Œæ ¼å¼åŒ–å‘½ä»¤ï¼ˆ`cd ui`ï¼‰ã€‚

---

### ğŸ”— ç›¸å…³æ–‡æ¡£

- [Husky å®˜æ–¹æ–‡æ¡£](https://typicode.github.io/husky/#/)
- [Prettier å®˜æ–¹æ–‡æ¡£](https://prettier.io/docs/en/index.html)
- [ESLint å®˜æ–¹æ–‡æ¡£](https://eslint.org/docs/latest/)

---

### ğŸ“ å°ç»“

é€šè¿‡ä¸Šè¿°æ­¥éª¤ï¼Œ**ä½ å°±å®ç°äº†ï¼š**
- æäº¤å‰è‡ªåŠ¨ä¿®å¤ä»£ç é£æ ¼ï¼ˆeslint + prettierï¼‰
- ä¸å†å› ä¸ºé£æ ¼é—®é¢˜äº§ç”Ÿå†²çªï¼Œé¿å…å¤šæ¬¡åˆå¹¶éº»çƒ¦
- ä¿æŒå›¢é˜Ÿä»£ç é£æ ¼ä¸€è‡´ï¼Œä½“éªŒæ›´æµç•…

